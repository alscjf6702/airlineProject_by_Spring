<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.airline.mapper.FlightMapper">

	<select id="getList" resultType="com.airline.vo.FlightVO">
	<![CDATA[
		select c.* from(select b.* from(select row_number() over(order by DEPDAY asc) as num, a.* from airplaneschedule a)b where num<= #{pageNum}* #{amount})c where num>= (#{pageNum}-1)* #{amount}
	 ]]>  
	</select>
	
	<select id="getListSearch" resultType="com.airline.vo.FlightVO">
	<![CDATA[
	 select c.* from
	(select b.* from
        (select row_number() over(order by DEPDAY asc) as num, a.* from airplaneschedule a
			where 1 = 1
			and DEPNAME like concat('%',#{dep},'%')
			and ARRNAME like concat('%',#{arr},'%')
			and DEPDAY like concat('%',#{time},'%')
		)b where num<= #{cri.pageNum}*#{cri.amount})c where num>= (#{cri.pageNum}-1)*#{cri.amount}
	 ]]>  
	</select>
	
<!-- 	<select id="getListSearch2" resultType="com.airline.vo.FlightVO">
	<![CDATA[
	 select c.* from
	(select b.* from
        (select row_number() over(order by DEPDAY asc) as num, a.* from airplaneschedule a
			where 1 = 1
			and DEPNAME like concat('%',#{dep},'%')
			and ARRNAME like concat('%',#{arr},'%')
			and DEPDAY like concat('%',#{time},'%')
		)b where num<= 1*10)c where num>= (1-1)* 10
	 
	 ]]>  
	</select> -->
	
	<select id="getTotal" resultType="int">
		select count(*) from airplaneschedule
	</select>
	
	<select id="getTotalSearch" resultType="int">
		select count(*) from airplaneschedule where 1 = 1
			and DEPNAME like concat('%',#{dep},'%')
			and ARRNAME like concat('%',#{arr},'%')
			and DEPDAY like concat('%',#{time},'%')
	</select>
	
	<select id="getFlightInfo" resultType="com.airline.vo.FlightVO">
		select * from airplaneschedule where fno=#{fno}
	</select>
	
	<select id="getPrice" resultType="int">
		select price from price where depname=#{depname} and arrname=#{arrname}
	</select>
	
	<select id="getUserAge" resultType="int">
		select userReginumFirst from kakaouser where userid = #{userid}
	</select>
	
	<select id="getAgeDiscount" resultType="float">
		select ageDiscountRate from discountpolicy where ageGroup = #{age}
	</select>
	
	<select id="getKakaoPoint" resultType="int">
		select sum(amount) from point where userid=#{userid}
	</select>
	
	<select id="getPoint" resultType="int">
		select sum(mileage) from userpay where userid=#{userid}
	</select>
	
	<select id="getCount" resultType="int">
		select count(userid) from userpay where userid=#{userid}
	</select>

	
</mapper>